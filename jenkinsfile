pipeline {
    agent any

    stages {
        stage('Run NGINX Container') {
            steps {
                sh 'docker run -d -p 8080:80 --name bharath nginx'  // Run the official NGINX container with custom name 'bharath'
            }
        }

        stage('Test Container') {
            steps {
                sh 'curl -I http://localhost:8080'  // Test if NGINX is running
            }
        }

        stage('Cleanup') {
            steps {
                sh 'docker ps -q --filter "name=bharath" | xargs -r docker stop && docker rm bharath'  // Cleanup the container
            }
        }
    }
}
